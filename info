# Step 1: Read the flat input format
df_flat = pd.read_excel("config_details.xlsx", sheet_name='Config')

# Step 2: Expand into two rows: Baseline and Test
baseline_df = df_flat.copy()
baseline_df['Source'] = 'Baseline'
baseline_df['Project'] = baseline_df['Baseline_Project']
baseline_df['Batch_Id'] = baseline_df['Baseline_Batch_Id']

test_df = df_flat.copy()
test_df['Source'] = 'Test'
test_df['Project'] = test_df['Test_Project']
test_df['Batch_Id'] = test_df['Test_Batch_Id']

# Step 3: Concatenate both
df_config = pd.concat([baseline_df, test_df], ignore_index=True)

# Step 4: Drop the flattened columns (optional)
df_config.drop(columns=['Baseline_Project', 'Baseline_Batch_Id', 'Test_Project', 'Test_Batch_Id'], inplace=True)