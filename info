# Define full and base keys
full_keys = ['Regulator', 'Site', 'Date', 'Source']
base_keys = ['Regulator', 'Site', 'Date']

# Step 1: Find duplicates on full key (including Source)
duplicate_rows = df_config[df_config.duplicated(subset=full_keys, keep=False)]

# Step 2: Get affected combinations excluding Source
affected_combinations = duplicate_rows[base_keys].drop_duplicates()

# Step 3: Print and drop all rows matching those (Regulator, Site, Date) combinations
if not affected_combinations.empty:
    for _, row in affected_combinations.iterrows():
        print(f"⚠️ Duplicate rows found under Source for Regulator: {row['Regulator']}, Site: {row['Site']}, Date: {row['Date']} — Skipping this combination.")
    
    # Drop all rows where (Regulator, Site, Date) match
    df_config = df_config[~df_config.set_index(base_keys).index.isin(affected_combinations.set_index(base_keys).index)]