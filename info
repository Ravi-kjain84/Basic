let
    Source = Resources_list,
    #"Removed Other Columns" = Table.SelectColumns(Source, {"Value Stream", "Unit Test", "Environment/ Smoke Test", "Functional Test", "Regression Test", "UAT", "Validation Test", "Test Mangers"}),
    #"Unpivoted Other Columns" = Table.UnpivotOtherColumns(#"Removed Other Columns", {"Value Stream"}, "Attribute", "Value"),
    #"Grouped Rows" = Table.Group(#"Unpivoted Other Columns", {"Value Stream", "Attribute"}, {{"Effort", each List.Sum([Value]), type number}}),
    #"Sorted Rows" = Table.Sort(#"Grouped Rows", {{"Effort", Order.Descending}}),
    
    // Calculate Total Effort
    TotalEffort = List.Sum(#"Sorted Rows"[Effort]),
    
    // Add Percentage Column
    #"Added Percent Column" = Table.AddColumn(#"Sorted Rows", "Effort %", each [Effort] / TotalEffort, type number),
    
    // Optional: Format Percentage
    #"Formatted Percent Column" = Table.TransformColumnTypes(#"Added Percent Column", {{"Effort %", Percentage.Type}})
in
    #"Formatted Percent Column"