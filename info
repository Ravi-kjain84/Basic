# Step: Validate uniqueness of Regulator + Source + Site + Date
dup_keys = ['Regulator', 'Source', 'Site', 'Date']

# Find duplicated combinations
duplicate_rows = df_config[df_config.duplicated(subset=dup_keys, keep=False)]

if not duplicate_rows.empty:
    grouped = duplicate_rows.groupby(dup_keys).size().reset_index(name='Count')
    for _, row in grouped.iterrows():
        print(f"⚠️ Duplicate rows found for Regulator: {row['Regulator']}, Source: {row['Source']}, Site: {row['Site']}, Date: {row['Date']} — Skipping this combination.")
    
    # Remove all rows that match the duplicate combinations
    df_config = df_config[~df_config.set_index(dup_keys).index.isin(grouped.set_index(dup_keys).index)]