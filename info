# Sanitize the composed prompt before sending
def clean_prompt(s: str) -> str:
    return (
        str(s)
        .replace("\r\n", "\n")
        .replace("\r", "\n")
        .strip("\x00")          # drop stray NULLs
        .strip()
    )

composed_prompt = clean_prompt(f"{prompt_template}\n\nRequirement:\n{requirement_text}")