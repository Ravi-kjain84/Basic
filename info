# Define the key combination for uniqueness *excluding* 'Source'
dup_keys = ['Regulator', 'Site', 'Date']

# Find duplicate combinations (ignoring Source)
duplicate_groups = (
    df_config
    .groupby(dup_keys)
    .size()
    .reset_index(name='Count')
    .query("Count > 1")
)

# Print and drop all rows that match these (Regulator, Site, Date) combos
if not duplicate_groups.empty:
    for _, row in duplicate_groups.iterrows():
        print(f"⚠️ Duplicate detected: Regulator: {row['Regulator']}, Site: {row['Site']}, Date: {row['Date']} — Skipping all rows for this combination.")

    # Remove all rows in df_config matching those (Regulator, Site, Date) keys
    df_config = df_config[~df_config.set_index(dup_keys).index.isin(duplicate_groups.set_index(dup_keys).index)]