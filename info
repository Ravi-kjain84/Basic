import pandas as pd
import os

def read_excel_file(filepath):
    ext = os.path.splitext(filepath)[1].lower()
    if ext == '.xls':
        # Use xlrd for old format
        return pd.read_excel(filepath, engine='xlrd')
    elif ext == '.xlsx':
        # Use openpyxl for new format
        return pd.read_excel(filepath, engine='openpyxl')
    else:
        raise ValueError("Unsupported file format")