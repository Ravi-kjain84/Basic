import os
import re

def normalize_filename(self, filename):
    """
    Normalize filename by removing:
    - the date (DD-MM-YYYY) after the first hyphen
    - the 14-digit timestamp just before the last part

    Args:
        filename (str): Original filename

    Returns:
        str: Normalized filename for matching
    """
    # Remove file extension
    name_without_ext = os.path.splitext(filename)[0].strip()

    # Split by ' - ' delimiter (consistent with the filenames shown)
    parts = name_without_ext.split(' - ')

    cleaned_parts = []

    for i, part in enumerate(parts):
        # Remove part if it's a date (e.g., 31-08-2024)
        if re.match(r"\d{2}-\d{2}-\d{4}$", part):
            continue

        # Remove part if it's a 14-digit timestamp (e.g., 20241105230128)
        if re.match(r"\d{14}$", part):
            continue

        cleaned_parts.append(part.strip())

    return " - ".join(cleaned_parts).lower()